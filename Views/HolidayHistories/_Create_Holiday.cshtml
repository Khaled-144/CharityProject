@model CharityProject.Models.HolidayHistory
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        .counter-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

    </style>
</head>

<div class="modal fade" id="insertModal" role="dialog">
    <div class="modal-dialog modal-xl">
        <div class="modal-content ">
            <div class="modal-header flex justify-center items-center ">
                <h4 class="modal-title text-center w-full">إنشاء معاملة جديدة</h4>
                <button type="button" class="btn btn-danger" data-dismiss="modal">X</button>
            </div>
            <div class="modal-body align-content-center">
                <div class="col-md text-right" dir="rtl">
                    <form asp-action="Create_2" method="post">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <div class="mb-4">
                            <label for="subject" class="block text-gray-700 font-bold mb-2">موضوع الإجازة</label>
                            <input type="text" id="subject" name="title" asp-for="title" class="border border-gray-400 rounded-md p-2 w-full" placeholder="أدخل موضوع الإجازة">
                        </div>
                        <div class="mb-4 flex items-center">
                            <label for="holidayType" class=" text-gray-700 font-bold ml-2">نوع الإجازة</label>
                            <select id="holidayType" name="holiday_id" class="border border-gray-400 rounded-md p-2 w-28 px-10 " onchange="handleHolidayTypeChange()" asp-for="holiday_id">
                                <option disabled selected> </option>
                                <option value="1">مرضية</option>
                                <option value="2">سنوية</option>
                                <option value="3">اضطرارية</option>
                                <option value="4">استئذان</option>
                            </select>
                            <label for="counter" class=" text-gray-700 font-bold mr-4" id="innertext">المدة بالأيام</label>
                            <div class="flex px-4">
                                <button type="button"  onclick="decrementCounter()" class="text-2xl">-</button>&nbsp;
                                <input type="number" asp-for="duration" id="counter" name="duration" class="w-12 p-2" value="1" min="1" readonly>&nbsp;
                                <button type="button" onclick="incrementCounter()" class="text-2xl">+</button>
                            </div>
                            <span class="text-gray-700 font-bold mx-2">من</span>
                            <input type="date" id="start_date" asp-for="start_date" name="start_date" class="border border-gray-400 rounded-md p-2 w-1/4 mr-2" onchange="updateEndDate()"><br />

                            <span class="text-gray-700 font-bold ">إلى</span>
                            <input type="date" id="end_date" asp-for="end_date" name="end_date" class="border border-gray-400 rounded-md p-2 mr-8  w-1/4">
                        </div>

                        <div class="mb-4">
                            <label for="notes" class="block text-gray-700 font-bold mb-2">الملاحظات</label>
                            <input type="text" id="notes" name="description" asp-for="description" class="border border-gray-400 rounded-md p-2 w-full " placeholder="أدخل الملاحظات"></input>
                        </div>

                        <div class="mb-4">
                            <label for="attachments" class="block text-gray-700 font-bold mb-2">المرفقات</label>
                            <div class="flex">
                                <input type="file" asp-for="files" id="attachment" name="files" class="border border-gray-400 rounded-md p-2 w-full">
                                
                            </div>
                        </div>
                        <div class="flex justify-between ">
                            <div class="mb-4 p-">
                                <label for="conf" class="block text-gray-700 font-bold mb-2 ">سرية المعاملة</label>
                                <input type="radio" id="conf" name="confidentiality1" class="m-1" value="0" /> غير سري<br />
                                <input type="radio" id="conf" name="confidentiality1" class="m-1" value="1" /> سري
                            </div>
                            <div class="mb-4 p-">
                                <label for="conf" class="block text-gray-700 font-bold mb-2 ">أعجلية المعاملة</label>
                                <input type="radio" id="conf" name="confidentiality2" class="m-1" value="0" />غير عاجلة <br />
                                <input type="radio" id="conf" name="confidentiality2" class="m-1" value="1" /> عاجلة<br />
                                <input type="radio" id="conf" name="confidentiality2" class="m-1" value="2" /> حالاً
                            </div>
                            <div class="mb-4 p-">
                                <label for="conf" class="block text-gray-700 font-bold mb-2 ">أهمية المعاملة</label>
                                <input type="radio" id="conf" name="confidentiality3" class="m-1" value="0" /> عادي <br />
                                <input type="radio" id="conf" name="confidentiality3" class="m-1" value="1" />هام
                            </div>
                        </div>


                        <div class="flex justify-center ">
                        <button type="submit" class=" bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded ">رفع الطلب</button>
                        </div>
                    </form>
                        

                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function handleHolidayTypeChange() {
        let currentDate;
        const holidayType = document.getElementById('holidayType').value;
        const startDateInput = document.getElementById('start_date');
        const endDateInput = document.getElementById('end_date');
        const counterInput = document.getElementById('counter');
        const counterLabel = document.getElementById('counterLabel');

        currentDate = new Date();
        let startDate = new Date(currentDate); // Copy the current date
        let endDate = new Date(currentDate); // Copy the current date

        startDateInput.value = startDate.toISOString().split('T')[0];

        // Set end date to current date + 1
        endDate.setDate(startDate.getDate() + 1);
        endDateInput.value = endDate.toISOString().split('T')[0];

        if (holidayType == 1) {
            counterLabel.innerText = 'المدة بالأيام';
        } else if (holidayType == 2) {
            currentDate.setDate(currentDate.getDate() + 3);
            startDateInput.value = currentDate.toISOString().split('T')[0];
            endDate.setDate(currentDate.getDate() + 1); // Update end date again
            endDateInput.value = endDate.toISOString().split('T')[0];
            counterLabel.innerText = 'المدة بالأيام';
            counterInput.max = '';
        } else if (holidayType == 3) {
            counterLabel.innerText = 'المدة بالأيام';
            counterInput.max = '10';
        } else if (holidayType == 4) {
            counterLabel.innerText = 'المدة بالساعات';
            counterInput.max = '2';
        } else {
            counterLabel.innerText = 'المدة بالأيام';
            counterInput.max = '';
        }

        updateEndDate();
    }

    function incrementCounter() {
        const counterInput = document.getElementById('counter');
        const holidayType = document.getElementById('holidayType').value;
        const max = holidayType === 'اضطرارية' ? 10 : (holidayType === 'استئذان' ? 2 : null);
        if (max === null || parseInt(counterInput.value) < max) {
            counterInput.value = parseInt(counterInput.value) + 1;
            updateEndDate();
        }
    }

    function decrementCounter() {
        const counterInput = document.getElementById('counter');
        if (parseInt(counterInput.value) > 1) {
            counterInput.value = parseInt(counterInput.value) - 1;
            updateEndDate();
        }
    }

    function updateEndDate() {
        const startDateInput = document.getElementById('start_date');
        const endDateInput = document.getElementById('end_date');
        const counterInput = document.getElementById('counter');
        const holidayType = document.getElementById('holidayType').value;

        if (startDateInput.value && holidayType !== 'استئذان') {
            let startDate = new Date(startDateInput.value);
            startDate.setDate(startDate.getDate() + parseInt(counterInput.value) - 1);
            endDateInput.value = startDate.toISOString().split('T')[0];
        }
    }
</script>
@*
<script>
	function handleHolidayTypeChange() {
		const holidayType = document.getElementById('holidayType').value;
		const startDateInput = document.getElementById('start_date');
		const counterInput = document.getElementById('counter');
		const counterLabel = document.getElementById('counterLabel');

		startDateInput.value = '';
		counterInput.value = '1';
		counterInput.readOnly = true;
		counterInput.max = '';
		counterLabel.innerText = 'المدة بالأيام';

		if (holidayType === 'سنوية') {
			const currentDate = new Date();
			currentDate.setDate(currentDate.getDate() + 3);
			startDateInput.value = currentDate.toISOString().split('T')[0];
			startDateInput.readOnly = true;
		} else if (holidayType === 'اضطرارية') {
			counterInput.max = '10';
		} else if (holidayType === 'استئذان') {
			counterLabel.innerText = 'المدة بالساعات';
			counterInput.max = '2';
		}

		updateEndDate();
	}

	function incrementCounter() {
		const counterInput = document.getElementById('counter');
		const holidayType = document.getElementById('holidayType').value;
		const max = counterInput.max ? parseInt(counterInput.max) : null;
		if (!max || parseInt(counterInput.value) < max) {
			counterInput.value = parseInt(counterInput.value) + 1;
			updateEndDate();
		}
	}

	function decrementCounter() {
		const counterInput = document.getElementById('counter');
		if (parseInt(counterInput.value) > 1) {
			counterInput.value = parseInt(counterInput.value) - 1;
			updateEndDate();
		}
	}

	function updateEndDate() {
		const startDateInput = document.getElementById('start_date');
		const endDateInput = document.getElementById('end_date');
		const counterInput = document.getElementById('counter');
		const holidayType = document.getElementById('holidayType').value;

		if (startDateInput.value && holidayType !== 'استئذان') {
			let startDate = new Date(startDateInput.value);
			startDate.setDate(startDate.getDate() + parseInt(counterInput.value) - 1);
			endDateInput.value = startDate.toISOString().split('T')[0];
		}
	}
</script> *@





